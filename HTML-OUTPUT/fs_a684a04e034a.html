<!DOCTYPE html>
<html>
<head>
   <title>Programmiermöglichkeiten in Transportkontrollskripten</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta name="description" content="TEXT SCRAMBLING in TRIAL VERSION OUTPUT! In evaluation mode, Help+Manual will scramble individual characters in random words in your published output files. This is a..." />
   <link type="text/css" href="./css/default.css" rel="stylesheet" />
   <link type="text/css" href="./css/custom.css" rel="stylesheet" />

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
        padding:0; 
        background: #ffffff; 
      } 
      div#printheader { display: none; }
      #idheader { 
        width:100%; 
        min-height: 60px; 
        padding: 0; 
        margin: 0;
        position: fixed;
        top: 0;
        background: #2C5D88;
        z-index: 2;
      } 
      /* The "min-height" for "#idheader table" ensures that the (blue) header of the topic
         has at least the same height as the header of the navigation panel left of it */
      #idheader table { min-height: 59px;}             
      #idheader h1 span { color: #FFF }     
      #idnav {
        text-align: right;
        width: 126px;
        vertical-align: middle;        
      } 
      #idnav a { text-decoration: none }
      #idnav span {
        display: inline-block;
        width: 24px;
        height: 24px;
        margin-left: 4px;
        background:url('./images/hm_webhelp_buttons_grey.png') top left no-repeat;
      } 
      #idnav a span {
        background-image:url('./images/hm_webhelp_buttons_white.png');
      } 
      #idnav a span:hover {
        background-image:url('./images/hm_webhelp_buttons_orange.png');
      } 
      #idnav span.hmbtnprev { background-position: 0 -32px }
      #idnav span.hmbtnnext { background-position: -24px -32px }
      #idnav span.hmbtntop  { background-position: -48px -32px }
      #idnav span.hmbtntoggle  { width: 20px; background-position: -70px -32px }
      #idnav span.hmbtnprint  { background-position: -88px -32px }

      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}       
      p.help-url { margin: 20px 0 5px 0; text-align: center; }
	  p.help-url a:link { font-size: 50%; text-decoration: none; color: black; }
	  p.help-url a:visited { color: black; }
	  p.help-url a:hover { font-size: 95%; text-decoration: underline; }
      #switchtoggles { text-align: right; padding: 0 2px 0 0; font-size: 90%; } 
      .sync-toc { color: #FFF; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #FFF; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #FFF; }
      .sync-toc a:hover { text-decoration: underline; }
	  a#printbuttonlink { cursor: pointer; }
      a.hmanchor { display: inline-block; margin-top: -4em; padding-top: 4em; }  
   </style>
   <style TYPE="text/css" media="print">
      div#idheader, img.dropdown-toggle-icon, p.help-url { display:none } 
   </style>
   
   <script type="text/javascript" src="./js/jquery.js"></script>
   <script type="text/javascript" src="./js/helpman_settings.js"></script>
   <script type="text/javascript" src="./js/helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "fs_a684a04e034a.html");
   </script>
   <script type="text/javascript" src="./js/highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<div id="printheader"><h1 class="p_Heading1" style="page-break-inside: avoid;"><span class="f_Heading1">Programmiermöglichkeiten in Transportkontrollskripten</span></h1>
</div>
<div id="idheader">
<div id="idheaderbg">
<table style="width:100%;border:none;margin:0px;" cellspacing="0" cellpadding="0"> 
  <tr>
    <td class="topichead" style="text-align:left; vertical-align:middle">
      <p class="sync-toc">&lt;&lt; <a rel="nofollow" href="index.html?fs_a684a04e034a.html" target="_top">Click to Display Table of Contents</a> &gt;&gt;</p>
      <p class="crumbs"><b>Navigation:</b>&nbsp;
      &raquo;No topics above this level&laquo;
      </p>
   
      <h1 class="p_Heading1" style="page-break-inside: avoid;"><span class="f_Heading1">Programmiermöglichkeiten in Transportkontrollskripten</span></h1>

    </td>
    <td class="topichead" id="idnav">
      
      <a href="fs_11ed2b9082ce.html" title="Previous Topic"><span class="hmbtnprev"></span></a>
      <a href="fs_8bd7d2d2d793.html" title="Parent Chapter"><span class="hmbtntop"></span></a>
      <a href="fs_3361362778f0.html" title="Next Topic"><span class="hmbtnnext"></span></a>
      
    </td>
  </tr>  
</table>
</div>
</div>  

<div id="idcontent"><div id="innerdiv">
<!-- Ask Internet Explorer 6.users to update their obsolete and dangerous browser --> 
<!--[if lt IE 7]><div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;'><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." /></a></div><![endif]-->

<!--ZOOMRESTART-->
<p class="p_Normal" style="page-break-inside: avoid;">TEXT SCRAMBLING in TRIAL VERSION OUTPUT! In evaluation mode, Help+Manual will scramble individual characters in random words in your published output files. This is a limitation of the free trial version. <a href="https://www.helpandmanual.com" target="_blank" class="weblink"> This help system was created with an evaluation copy of Help+Manual.</a></p>
<hr style="height:2px; color:#FF0000; border-width:0; background-color:#ff0000;" /><p class="p_Normal" style="page-break-inside: avoid;">&nbsp;</p>
<p class="p_Normal" style="page-break-inside: avoid;">Sie können in Transportkontrollskripten sämtliche Möglichkeiten nutzen, die Custom Code in IKAROS bietet, da die Skripte im Zielsystem von IKAROS selbst ausgeführt werden.</p>
<p class="p_UeberschriftEinfach" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_UeberschriftEinfach">Einschränkungen</span></p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">Benutzerinteraktion (u. a. Anzeige von Dialogen oder Abfragen) ist innerhalb des Skripts nicht möglich.</span></p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">Es ist nicht möglich, den Inhalt des aktuellen Artefaktpakets per Programmierung generisch abzufragen oder zu verändern. Beim Entwickeln eines Transportkontrollskripts müssen Sie daher wissen, welche Artefakte im Paket enthalten sein werden, falls Sie z. B. Vergleiche im Zielsystem vornehmen möchten.</span></p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">Die Skripte werden im IKAROS-Zielsystem ausgeführt. Falls Sie in den Skripten auf externe Programme zugreifen (z. B. CMD-Befehle ausführen) oder externe Dateien schreiben/auslesen, müssen Sie sicherstellen, dass alle potenziellen IKAROS-Zielsysteme die entsprechenden Zugriffe erlauben.</span></p>
<p class="p_UeberschriftEinfach" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_UeberschriftEinfach">Ergebnisse der Transportkontrollskripte im Transportprotokoll</span></p>
<p class="p_Normal" style="page-break-inside: avoid;">Meldungen, die mittels der Transportkontrollskripte in das Transportprotokoll geschrieben wurden, stehen im TRMS-Protokoll in einem eigenen Knoten „Transportkontrollskripte“:</p>
<p class="p_Verknuepfung" style="page-break-inside: avoid; page-break-after: avoid;"><img alt="_HelpPlusManual_TRMS_img150" width="528" height="239" style="margin:0;width:528px;height:239px;border:none" src="./images/_helpplusmanual_trms_img150.png"/></p>
<p class="p_caption" style="page-break-inside: avoid;"><span class="f_caption">Abb. 44: Ergebnisse des Finalisierungs-Skripts im Transport-Protokoll</span></p>
<p class="p_UeberschriftEinfach_Gross" style="page-break-inside: avoid; page-break-after: avoid; border-top: none; border-right: none; border-left: none;"><span class="f_UeberschriftEinfach_Gross">Verwendung von LINQ</span></p>
<p class="p_Normal" style="page-break-inside: avoid;"><span class="f_Editionshinweis">Hinweis: In IKAROS basic/starter kann LINQ nicht verwendet werden.</span></p>
<p class="p_Normal" style="page-break-inside: avoid;">Häufig werden Sie LINQ benötigen, um z. B. abzufragen, ob bestimmte Stammdaten im Zielsystem schon vorhanden sind (bzw. mit welchem Änderungsstand).</p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">Custom Code bietet für viele, allerdings nicht alle, möglichen Artefakt-Typen bereits eigene Objekte an. Dann können Sie per LINQ direkt Objekte ermitteln. Beispielsweise für Aktenvorgangsvorlagen:</span></p>
<p class="p_Quellcode_Eingerueckt_OhneFarbe" style="page-break-inside: avoid;"><span class="f_Quellcode_Eingerueckt_OhneFarbe">const eventTemplate = linq.execute('from e in @EventTemplate where e.eventCode === &quot;Z001&quot; select e').singleOrDefault();</span></p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">Per LINQ können Sie auch andere Stammdaten abfragen, für die es in IKAROS keine Objekte gibt. Dann müssen Sie sich allerdings in LINQ per „new“-Anweisung typenlose Objekte zusammenstellen und diese zurückliefern lassen:</span></p>
<p class="p_Quellcode_Eingerueckt_OhneFarbe" style="page-break-inside: avoid;"><span class="f_Quellcode_Eingerueckt_OhneFarbe">const ccAppToTransport = {</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; designation: 'Erfolgsstatistik',</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; nameSpace: 'Fs',</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; versionNo: 1</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">};</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">const allCcApps = linq.execute('from app in @CustomApp select' +</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; ' new { designation = app.designation, nameSpace = app.nameSpace, versionNo = app.versionNo, ID = app.customCode.Id, cvId = app.CvId }').toList();</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">if (allCcApps.some(app =&gt; app.designation === ccAppToTransport.designation &amp;&amp;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; &nbsp; &nbsp;app.nameSpace === ccAppToTransport.nameSpace &amp;&amp;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; &nbsp; &nbsp;app.versionNo === ccAppToTransport.versionNo)) {</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; trms.reportInfo('Custom Code app &quot;' + ccAppToTransport.nameSpace + '.' + ccAppToTransport.designation + '&quot; already in target system.');</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">}</span></p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">Oder Sie können die Suche nach den Stammdaten direkt in die LINQ-Abfrage integrieren:</span></p>
<p class="p_Quellcode_Eingerueckt_OhneFarbe" style="page-break-inside: avoid;"><span class="f_Quellcode_Eingerueckt_OhneFarbe">const ccAppToTransport = {</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; designation: 'Erfolgsstatistik',</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; nameSpace: 'Fs',</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; versionNo: 1</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">};</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">const appExists = linq.execute(`from app in @CustomApp where app.designation === &quot;${ccAppToTransport.designation}&quot; &amp;&amp; </span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; app.nameSpace === &quot;${ccAppToTransport.nameSpace}&quot; &amp;&amp; </span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; app.versionNo.toString() === &quot;${ccAppToTransport.versionNo}&quot;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; select app.id`).any();</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">if (appExists) {</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe"> &nbsp; trms.reportInfo('Custom Code app &quot;' + ccAppToTransport.nameSpace + '.' + ccAppToTransport.designation + '&quot; already in target system.');</span><br />
<span class="f_Quellcode_Eingerueckt_OhneFarbe">}</span></p>
<p class="p_UeberschriftEinfach_Gross" style="page-break-inside: avoid; page-break-after: avoid; border-top: none; border-right: none; border-left: none;"><span class="f_UeberschriftEinfach_Gross">TRMS-spezifische Zugriffe</span></p>
<p class="p_Normal" style="page-break-inside: avoid;">Nur in Code, der als Transportkontrollskript ausgeführt wird, können Sie die Zugriffe des „Trms“-Objekts nutzen:</p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">„</span><span class="f_Strong">trms.reportInfo()</span><span class="f_Aufzaehlung1">“: Schreibt „Information“-Einträge ins Transportprotokoll.</span></p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">„</span><span class="f_Strong">trms.reportError()</span><span class="f_Aufzaehlung1">“: Schreibt einerseits „Fehler“-Einträge ins Transportprotokoll. Andererseits bewirkt die Methode in Prerequisite- und Initialisierungs-Skripten, dass &nbsp;kein einziges Artefakt aus der transportierten Paketdatei im Zielsystem installiert wird. Die Skriptausführung wird trotz solcher Fehler fortgesetzt, sodass Sie auch mehrere solcher Fehler protokollieren können. Allerdings führt schon der erste Aufruf dazu, dass bei einem tatsächlichen Transport aus dem TRMS kein Artefakt in das Zielsystem eingespielt würde.</span></p>
<p class="p_Aufzaehlung1" style="text-indent: 0; page-break-inside: avoid; padding-left: 24px; margin-left: 0;"><span class="f_Aufzaehlung1" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:24px;margin-left:-24px">&#8226;</span><span class="f_Aufzaehlung1">„</span><span class="f_Strong">Trms.transportSuccessful</span><span class="f_Aufzaehlung1">“: Liefert einen logischen Wert, ob alle Artefakte erfolgreich transportiert wurden (true), oder ob bei mindestens einem im Zielsystem ein Fehler aufgetreten ist (false).</span></p>
<p class="p_UeberschriftEinfach" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_UeberschriftEinfach">Speziell verfügbare globale Variablen</span></p>
<div style="text-align: left; text-indent: 0; page-break-inside: avoid; padding: 0 0 0 0; margin: 4px 0 4px 8px;"><table style="border:none; border-spacing:0; border-collapse:collapse;">
<tr>
<td style="vertical-align:top; width:55px; padding:6px; border:solid thin #a6a6a6;"><p class="p_Normal" style="text-align: center; page-break-inside: avoid; page-break-after: avoid;"><strong style="font-weight: bold; color: #ffffff;">Variable</strong></p>
</td>
<td style="vertical-align:top; width:511px; padding:6px; border:solid thin #a6a6a6;"><p class="p_Normal" style="text-align: center; page-break-inside: avoid; page-break-after: avoid;"><strong style="font-weight: bold; color: #ffffff;">Beschreibung</strong></p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:55px; padding:6px; border:solid thin #a6a6a6;"><p class="p_Normal" style="page-break-inside: avoid;"><span style="font-size: 12px;">trms</span></p>
</td>
<td style="vertical-align:top; width:511px; padding:6px; border:solid thin #a6a6a6;"><p class="p_Normal" style="page-break-inside: avoid;"><span style="font-size: 12px;">Das „trms“-Objekt ist nur nutzbar, wenn der Code als Transportkontrollskript ausgeführt wird. Nur dann haben Sie auch Zugriff auf dessen Methoden zum Schreiben von Einträgen in das Transportprotokoll.</span></p>
</td>
</tr>
</table>
</div>
<p class="p_UeberschriftEinfach" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_UeberschriftEinfach">Tipp: TRMS-Skripte in IKAROS lauffähig machen</span></p>
<p class="p_Normal" style="page-break-inside: avoid;">Die Nutzung der Zugriffe am „trms“-Objekt führen in IKAROS zu einem Fehler, wenn der Code nicht als Transportkontrollskript ausführt wird. Um ein Skript dennoch in IKAROS selbst entwickeln und testen zu können, bietet der Editor-Dialog im TRMS die Schaltflächen „<span class="f_Strong">Code für IKAROS kopieren</span>“ und „<span class="f_Strong">Code von IKAROS einfügen</span>“ an.</p>
<p class="p_Normal" style="page-break-inside: avoid;">Wenn Sie den Code aus dem Editor durch Klick auf „Code für IKAROS kopieren“ in die Zwischenablage kopieren (es muss mindestens ein Zeichen im Editor stehen), reichert das TRMS Ihren Code automatisch mit generischem Custom Code an, der den gesamten Code im JavaScript-Editor von IKAROS lauffähig macht.</p>
<p class="p_Normal" style="page-break-inside: avoid;">Dieser Code wird am Anfang Ihres Codes eingefügt:</p>
<p class="p_Quellcode_OhneFarbe" style="page-break-inside: avoid;"><span class="f_Quellcode_OhneFarbe">(() =&gt; {class Trms {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;constructor() {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;/** @type {{type: &quot;E&quot; | &quot;M&quot;, message: string}[]} */</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;this.messages = [];</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;}</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;/**</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; * @param {(trms: Trms) =&gt; boolean | void} callback</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; */</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;runScript(callback) {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;callback(this);</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;let result = 'S'; </span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;if (this.messages.some(x =&gt; x.type === 'E'))</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;result = 'E';</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;return JSON.stringify({</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;result: result,</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messages: this.messages</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;});</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;}</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;/**</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; * @param {string} message</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; */</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;reportError(message) {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;this.messages.push({ type: 'E', message });</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;}</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;/**</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; * @param {string} message</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; */</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;reportInfo(message) {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp; &nbsp;this.messages.push({ type: 'M', message });</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;}</span><br />
<span class="f_Quellcode_OhneFarbe">}</span><br />
<span class="f_Quellcode_OhneFarbe">return new Trms().runScript(trms =&gt; {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; </span><span class="f_Strong">// Code des eigentlichen Transportkontrollskripts</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp;</span><br />
<span class="f_Quellcode_OhneFarbe">});</span><br />
<span class="f_Quellcode_OhneFarbe">})();</span></p>
<p class="p_UeberschriftEinfach" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_UeberschriftEinfach">Rückgabe-Objekt mit den Meldungen</span></p>
<p class="p_Normal" style="page-break-inside: avoid;">Bei Ausführung gibt dieser Code ein Objekt zurück, das einen Buchstaben für das Ausführungsergebnis sowie ein Array von Objekten enthält, welche die protokollierten Meldungen repräsentieren:</p>
<p class="p_Quellcode_OhneFarbe" style="page-break-inside: avoid;"><span class="f_Quellcode_OhneFarbe">{</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; result: &quot;S&quot;, // &quot;S&quot; = success, &quot;E&quot; = error</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; messages: [{</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;type: &quot;M&quot;,</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;message: &quot;Text einer Infomeldung ...&quot;</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; }, {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;type: &quot;E&quot;,</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;message: &quot;Text einer Fehlermeldung ...&quot;</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; }]</span><br />
<span class="f_Quellcode_OhneFarbe">}</span></p>
<p class="p_Normal" style="page-break-inside: avoid;">Nach der Entwicklung in IKAROS müssen Sie den Code im Ganzen kopieren und dann im TRMS per Schaltfläche „Code von IKAROS einfügen“ einfügen. Dabei wird der zuvor angereicherte Code automatisch wieder entfernt.</p>
<p class="p_UeberschriftEinfach_Gross" style="page-break-inside: avoid; page-break-after: avoid; border-top: none; border-right: none; border-left: none;"><span class="f_UeberschriftEinfach_Gross">Beispiel</span></p>
<p class="p_Normal" style="page-break-inside: avoid;">In dem folgenden einfachen Beispiel wird per LINQ geprüft, ob im Zielsystem eine Aktenvorgangsvorlage „Z001“ existiert und ob entsprechende Vorgänge bereits in Akten angelegt wurden:</p>
<p class="p_Quellcode_OhneFarbe" style="page-break-inside: avoid;"><span class="f_Quellcode_OhneFarbe">const eventTemplateCode = 'Z001';</span><br />
<span class="f_Quellcode_OhneFarbe">const targetEnvironmentInfo =</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; fs.getSetting('SCHEME_VERSION') + ' (' + fs.getSetting('IKAROS-Umgebung') + ')';</span><br />
<span class="f_Quellcode_OhneFarbe">const eventTemplate =</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; linq.execute(`from e in @EventTemplate where </span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; e.eventCode === &quot;${eventTemplateCode}&quot; select e`).singleOrDefault();</span><br />
<span class="f_Quellcode_OhneFarbe">if (eventTemplate !== null) {</span><br />
<span class="f_Quellcode_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; trms.reportInfo('Event template &quot;' + eventTemplateCode + '&quot; with last change date ' +</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;eventTemplate.lastUpdate.toLocaleShortDateString() + ' exists in the target environment ' +</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;targetEnvironmentInfo + ').');</span><br />
<span class="f_Quellcode_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; if (linq.execute(`from e in @Event </span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;where e.EventTemplate.eventCode === &quot;${eventTemplateCode}&quot; select e`).any()) {</span><br />
<span class="f_Quellcode_OhneFarbe">&nbsp;</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;trms.reportInfo('Actual &quot;' + eventTemplateCode + '&quot; events in cases found.');</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; } else {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;trms.reportError('No &quot;' + eventTemplateCode + '&quot; events not found in any IKAROS case!');</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; }</span><br />
<span class="f_Quellcode_OhneFarbe">} else {</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; trms.reportError('Event template &quot;' + eventTemplateCode +</span><br />
<span class="f_Quellcode_OhneFarbe"> &nbsp; &nbsp; &nbsp;'&quot; does not exist in the target environment ' + targetEnvironmentInfo + ').');</span><br />
<span class="f_Quellcode_OhneFarbe">}</span></p>

<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">



function normHeaders() {
 var topicHeadHeight =  $("#idheaderbg > table").first().height() + 1,
	 $topicHeaderBox = $("#idheader"),
	 $topicContentBox = $("#idcontent"),
	 $navHeader = $("#navbar", parent.document),			 
	$navBox = $("div#hmnavframe", parent.document),
	 navHeaderHeight = $navHeader.height();
 if (topicHeadHeight != navHeaderHeight) {
	 $navHeader.css("height",topicHeadHeight + "px");
	 $navBox.css("top", topicHeadHeight + "px");
	 $topicHeaderBox.css("height", topicHeadHeight + "px");
		if ($topicHeaderBox.css("position") == "fixed"){
			$topicContentBox.css("margin-top", topicHeadHeight + "px");
			}
		}
    }
			 
  $(document).ready(function(){
    $(window).on('resize', function() {
      var y = $('#idheader').height(); 
      $('#idcontent').css('margin-top', y);
      var par = window.parent;
      if ($( par ).width() <= $( window ).width()+20) {
        $('#idheader').css('position', 'relative');
        $('#idcontent').css('margin-top', 0);
        $('#idbacktotop').css('display', 'block');
        $('.hmanchor').css('margin-top', -20);
	$('.hmanchor').css('padding-top', 20);
      }
      else {
        $('#idheader').css('position', 'fixed');
        $('#idcontent').css('margin-top', $('#idheader').height());
        $('#idbacktotop').css('display', 'none');
        $('.hmanchor').css('margin-top', -y-20);
		$('.hmanchor').css('padding-top', y+20);
		$("div#hmsplitter", parent.document).css('width', '3px');
      }
	normHeaders();
    });
    
	 $(window).resize(); //trigger event for initially small displays
  });
 

if ((!parent.hmNavigationFrame) && (parent.location) && (parent.location.href)) { $('.sync-toc').show();$('p.crumbs').hide();}

</script>
</body>
</html>
